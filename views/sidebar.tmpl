{{ define "sidebar" }}
		<aside class="sidebar" aria-label="Primary">
			<div class="profile-card">
				<div class="avatar-wrap">
					<img class="avatar" src="/img/logo.png" alt="User avatar" />
					<div class="avatar-fallback" aria-hidden="true"></div>
				</div>
				<div class="username">SparkProxy</div>
			</div>

			<div class="sidebar-card">
				<nav class="nav-group">
					<a class="nav-item{{if eq .ActivePage "dashboard"}} is-active{{end}}" href="/dashboard">
						<span class="icon" aria-hidden="true">
							<svg width="18" height="18" viewBox="0 0 24 24" fill="none">
								<rect x="3" y="3" width="8" height="8" rx="2" stroke="currentColor" stroke-width="2"/>
								<rect x="13" y="3" width="8" height="5" rx="2" stroke="currentColor" stroke-width="2"/>
								<rect x="13" y="10" width="8" height="11" rx="2" stroke="currentColor" stroke-width="2"/>
								<rect x="3" y="13" width="8" height="8" rx="2" stroke="currentColor" stroke-width="2"/>
							</svg>
						</span>
						<span>Dashboard</span>
					</a>
				</nav>
			</div>

				<div class="sidebar-card">
				<nav class="nav-group">
					<div class="group-title">Network</div>
					<a class="nav-item{{if eq .ActivePage "domains"}} is-active{{end}}" href="/domains">
						<span class="icon" aria-hidden="true">
							<svg width="16px" height="16px" viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg">
								<title>domain</title>
								<g id="Layer_2" data-name="Layer 2">
									<g id="invisible_box" data-name="invisible box">
										<rect width="48" height="48" fill="none"></rect>
									</g>
									<g id="icons_Q2" data-name="icons Q2">
										<path stroke="#ffffff" d="M24,2A22,22,0,1,0,46,24,21.9,21.9,0,0,0,24,2ZM40.1,16H35.2a27.8,27.8,0,0,0-3-8A18.5,18.5,0,0,1,40.1,16ZM42,24a17.5,17.5,0,0,1-.5,4H35.8c.1-1.3.2-2.6.2-4s-.1-2.7-.2-4h5.7A17.5,17.5,0,0,1,42,24ZM6,24a17.5,17.5,0,0,1,.5-4h5.7c-.1,1.3-.2,2.6-.2,4s.1,2.7.2,4H6.5A17.5,17.5,0,0,1,6,24Zm10,0c0-1.4.1-2.7.2-4H22v8H16.2C16.1,26.7,16,25.4,16,24ZM26,6.7a11.7,11.7,0,0,1,3,3.7A21.7,21.7,0,0,1,31.1,16H26Zm-4,0V16H16.9A21.7,21.7,0,0,1,19,10.4,11.7,11.7,0,0,1,22,6.7ZM22,32v9.3a11.7,11.7,0,0,1-3-3.7A21.7,21.7,0,0,1,16.9,32Zm4,9.3V32h5.1A21.7,21.7,0,0,1,29,37.6,11.7,11.7,0,0,1,26,41.3ZM26,28V20h5.8c.1,1.3.2,2.6.2,4s-.1,2.7-.2,4ZM15.8,8a27.8,27.8,0,0,0-3,8H7.9A18.5,18.5,0,0,1,15.8,8ZM7.9,32h4.9a27.8,27.8,0,0,0,3,8A18.5,18.5,0,0,1,7.9,32Zm24.3,8a27.8,27.8,0,0,0,3-8h4.9A18.5,18.5,0,0,1,32.2,40Z"></path>
									</g>
								</g>
							</svg>
						</span>
						<span>Domains</span>
					</a>
					<a class="nav-item{{if eq .ActivePage "streams"}} is-active{{end}}" href="/streams">
						<span class="icon" aria-hidden="true">
							<svg width="18" height="18" viewBox="0 0 24 24" fill="none">
								<path d="M22 12h-4l-3 9L9 3l-3 9H2" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
							</svg>
						</span>
						<span>Streams</span>
					</a>
					<a class="nav-item{{if eq .ActivePage "analytics"}} is-active{{end}}" href="/analytics">
						<span class="icon" aria-hidden="true">
							<svg width="18" height="18" viewBox="0 0 24 24" fill="none">
								<path d="M3 17l6-6 4 4 8-10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
							</svg>
						</span>
						<span>Analytics</span>
					</a>
					<a class="nav-item{{if eq .ActivePage "rate-limits"}} is-active{{end}}" href="/rate-limits">
						<span class="icon" aria-hidden="true">
							<svg width="18" height="18" viewBox="0 0 24 24" fill="none">
								<path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
							</svg>
						</span>
						<span>Rate Limits</span>
					</a>
					<a class="nav-item{{if eq .ActivePage "logs"}} is-active{{end}}" href="/logs">
						<span class="icon" aria-hidden="true">
							<svg width="18" height="18" viewBox="0 0 24 24" fill="none">
								<path d="M6 3h9l5 5v13a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z" stroke="currentColor" stroke-width="2"/>
								<path d="M9 12h6M9 16h6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
							</svg>
						</span>
						<span>Logs</span>
					</a>
				</nav>
			</div>

				<div class="sidebar-card">
				<nav class="nav-group">
					<div class="group-title">Access Control</div>
					<a class="nav-item{{if eq .ActivePage "users"}} is-active{{end}}" href="/users">
						<span class="icon" aria-hidden="true">
							<svg width="18" height="18" viewBox="0 0 24 24" fill="none">
								<circle cx="12" cy="8" r="4" stroke="currentColor" stroke-width="2"/>
								<path d="M4 20c0-4 4-6 8-6s8 2 8 6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
							</svg>
						</span>
						<span>Users</span>
					</a>
					<a class="nav-item{{if eq .ActivePage "identity-providers"}} is-active{{end}}" href="/identity-providers">
						<span class="icon" aria-hidden="true">
							<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
								<path d="M12 10a2 2 0 0 0-2 2c0 1.02-.1 2.51-.26 4"/>
								<path d="M14 13.12c0 2.38 0 6.38-1 8.88"/>
								<path d="M17.29 21.02c.12-.6.43-2.3.5-3.02"/>
								<path d="M2 12a10 10 0 0 1 18-6"/>
								<path d="M2 16h.01"/>
								<path d="M21.8 16c.2-2 .131-5.354 0-6"/>
								<path d="M5 19.5C5.5 18 6 15 6 12a6 6 0 0 1 .34-2"/>
								<path d="M8.65 22c.21-.66.45-1.32.57-2"/>
								<path d="M9 6.8a6 6 0 0 1 9 5.2v2"/>
							</svg>
						</span>
						<span>Identity Providers</span>
					</a>
					<a class="nav-item{{if eq .ActivePage "roles"}} is-active{{end}}" href="/roles">
						<span class="icon" aria-hidden="true">
							<svg width="18" height="18" viewBox="0 0 24 24" fill="none">
								<path d="M12 2l7 4v6c0 5-4 9-7 10-3-1-7-5-7-10V6l7-4z" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/>
							</svg>
						</span>
						<span>Roles</span>
					</a>
					<a class="nav-item{{if eq .ActivePage "sessions"}} is-active{{end}}" href="/sessions">
						<span class="icon" aria-hidden="true">
							<svg width="18" height="18" viewBox="0 0 24 24" fill="none">
								<path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
								<circle cx="9" cy="7" r="4" stroke="currentColor" stroke-width="2"/>
								<path d="M23 21v-2a4 4 0 0 0-3-3.87M16 3.13a4 4 0 0 1 0 7.75" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
							</svg>
						</span>
						<span>Sessions</span>
					</a>
					<a class="nav-item{{if eq .ActivePage "firewall"}} is-active{{end}}" href="/firewall">
						<span class="icon" aria-hidden="true">
							<svg width="18" height="18" viewBox="0 0 24 24" fill="none">
								<path d="M12 2L3 7v6c0 5.5 4 10 9 11 5-1 9-5.5 9-11V7l-9-5z" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/>
							</svg>
						</span>
						<span>Firewall</span>
					</a>
					<a class="nav-item{{if eq .ActivePage "audit"}} is-active{{end}}" href="/audit">
						<span class="icon" aria-hidden="true">
							<svg width="18" height="18" viewBox="0 0 24 24" fill="none">
								<path d="M6 3h9l5 5v13a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z" stroke="currentColor" stroke-width="2"/>
								<path d="M9 12h6M9 16h6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
							</svg>
						</span>
						<span>Audit Logs</span>
					</a>
					<a class="nav-item{{if eq .ActivePage "api-tokens"}} is-active{{end}}" href="/api-tokens">
						<span class="icon" aria-hidden="true">
							<svg width="18" height="18" viewBox="0 0 24 24" fill="none">
								<path d="M21 2l-2 2m-7.61 7.61a5.5 5.5 0 1 1-7.778 7.778 5.5 5.5 0 0 1 7.777-7.777zm0 0L15.5 7.5m0 0l3 3L22 7l-3-3m-3.5 3.5L19 4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
							</svg>
						</span>
						<span>API Tokens</span>
					</a>
				</nav>
			</div>

				<div class="sidebar-card">
				<nav class="nav-group">
					<div class="group-title">Security</div>
					<a class="nav-item{{if eq .ActivePage "passkeys"}} is-active{{end}}" href="/passkeys">
						<span class="icon" aria-hidden="true">
							<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
								<path d="M12 10a2 2 0 0 0-2 2c0 1.02-.1 2.51-.26 4"/>
								<path d="M14 13.12c0 2.38 0 6.38-1 8.88"/>
								<path d="M17.29 21.02c.12-.6.43-2.3.5-3.02"/>
								<path d="M2 12a10 10 0 0 1 18-6"/>
								<path d="M2 16h.01"/>
								<path d="M21.8 16c.2-2 .131-5.354 0-6"/>
								<path d="M5 19.5C5.5 18 6 15 6 12a6 6 0 0 1 .34-2"/>
								<path d="M8.65 22c.21-.66.45-1.32.57-2"/>
								<path d="M9 6.8a6 6 0 0 1 9 5.2v2"/>
							</svg>
						</span>
						<span>Passkeys</span>
					</a>
					<a class="nav-item{{if eq .ActivePage "linked-accounts"}} is-active{{end}}" href="/linked-accounts">
						<span class="icon" aria-hidden="true">
							<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
								<path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/>
								<path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/>
							</svg>
						</span>
						<span>Linked Accounts</span>
					</a>
					<a class="nav-item{{if eq .ActivePage "settings"}} is-active{{end}}" href="/settings">
						<span class="icon" aria-hidden="true">
							<svg width="18" height="18" viewBox="0 0 24 24" fill="none">
								<circle cx="12" cy="12" r="3" stroke="currentColor" stroke-width="2"/>
								<path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
							</svg>
						</span>
						<span>Settings</span>
					</a>
				</nav>
			</div>
		</aside>

		<script>
		(function(){
		  const card = document.querySelector('.profile-card');
		  if(!card) return;
		  const img = card.querySelector('.avatar');
		  const fallback = card.querySelector('.avatar-fallback');
		  const nameEl = card.querySelector('.username');
		  const initial = (nameEl && nameEl.textContent || '').trim().charAt(0).toUpperCase() || '?';
		  if(fallback){ fallback.textContent = initial; }
		  function showFallback(){ if(img){ img.style.display='none'; } if(fallback){ fallback.style.display='grid'; } }
		  if(!img || !img.getAttribute('src')){ showFallback(); }
		  else { img.addEventListener('error', showFallback); }
		})();
		</script>
{{ end }}